(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{ys8N:function(e,t,a){"use strict";var l=a("TqRt"),n=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var u=l(a("bx4M"));a("/zsF");var r=l(a("PArb"));a("T2oS");var d=l(a("W9HT"));a("giR+");var f=l(a("fyUT"));a("14J3");var c=l(a("BMrR"));a("5Dmo");var o=l(a("3S7+"));a("+L6B");var i=l(a("2/Rp"));a("+BJd");var s=l(a("mr32"));a("7Kak");var m=l(a("9yH6")),E=l(a("pVnL"));a("jCWc");var p=l(a("kPKH"));a("2qtc");var g=l(a("kLXV")),v=l(a("lwsE")),h=l(a("W8MJ")),b=l(a("a1gu")),C=l(a("Nsbk")),y=l(a("7W2i"));a("iQDF");var k=l(a("+eQT"));a("OaEy");var M=l(a("2fM7"));a("5NDa");var R=l(a("5rEg"));a("y8nQ");var S=l(a("Vl3Y")),w=n(a("q1tI")),N=a("MuoO"),q=l(a("usdK")),L=l(a("IkuO")),T=l(a("wd/R"));a("XDpg");var x,D,V,O=a("Ig5U"),B=a("4ZfN"),Y=a("d9J6"),F=l(a("A4CJ")),I=l(a("mNfy")),J=l(a("mDQx"));T.default.locale("zh-cn");var P=S.default.Item,A=R.default.TextArea,j=M.default.Option,z=k.default.RangePicker,Q=(x=(0,N.connect)(function(e){var t=e.contractdata,a=e.modelutil;return{contractdata:t,modelutil:a}}),D=S.default.create(),x(V=D(V=function(e){function t(){var e,a;(0,v.default)(this,t);for(var l=arguments.length,n=new Array(l),u=0;u<l;u++)n[u]=arguments[u];return a=(0,b.default)(this,(e=(0,C.default)(t)).call.apply(e,[this].concat(n))),a.state={loading:!1,showSelectModal:!1,linkContarct:"",showLink:!0},a.componentDidMount=function(){a.getModelNum()},a.btnCurrent=function(){var e=a.state.linkContarct,t=a.props,l=t.dispatch,n=t.form;n.validateFields(function(t,n){if(!t){var u=n;n.statisticalmonth&&(u.statisticalmonth=(0,T.default)(n.statisticalmonth).format("YYYY-MM")),n.signingdateLong&&(u.signingdateLong=(0,T.default)(n.signingdateLong).valueOf()),n.usesealdateLong&&(u.usesealdateLong=(0,T.default)(n.usesealdateLong).valueOf()),n.startEndRange&&2===n.startEndRange.length&&(u.begindateLong=(0,T.default)(n.startEndRange[0]).valueOf(),u.enddateLong=(0,T.default)(n.startEndRange[1]).valueOf()),u.startEndRange=[],u.relatedcontractname=e,a.setState({loading:!0}),l({type:"contractdata/addData",payload:u}).then(function(e){e.statusCode?(g.default.error({title:"\u9519\u8bef\u4fe1\u606f",content:"\u670d\u52a1\u7aef\u9519\u8bef\uff0c\u9519\u8bef\u4ee3\u7801\uff1a ".concat(e.statusCode)}),a.setState({loading:!1})):(-1===e.code?g.default.error({title:"\u9519\u8bef\u4fe1\u606f",content:"\u670d\u52a1\u7aef\u9519\u8bef\uff0c\u9519\u8bef\u4ee3\u7801\uff1a ".concat(e.msg,"\u8bf7\u70b9\u51fb\u786e\u5b9a\u6309\u94ae\u91cd\u65b0\u83b7\u53d6\u5408\u540c\u7f16\u53f7\u3002"),okText:"\u786e\u5b9a",onOk:function(){return a.getModelNum()}}):q.default.push({pathname:"/compact/contract-add/confirm",query:{contractid:e.data}}),a.setState({loading:!1}))})}})},a.openSelectContratc=function(e,t){var l=a.state.linkContarct;a.setState({showSelectModal:!!e}),t?(a.setState({linkContarct:t.join("\uff0c")}),a.selectData(t)):(a.child.getCon(),a.child.setState({condata:""===l?[]:l.split("\uff0c")}))},a.getModelNum=function(){var e=a.props,t=e.dispatch,l=e.form;a.setState({loading:!0}),t({type:"modelutil/getConNum",payload:{}}).then(function(e){if(e.statusCode)g.default.error({title:"\u9519\u8bef\u4fe1\u606f",content:"\u670d\u52a1\u7aef\u9519\u8bef\uff0c\u9519\u8bef\u4ee3\u7801\uff1a ".concat(e.statusCode)});else{var t=(0,T.default)().format("YYYYMMDD"),n="";n="1"===l.getFieldValue("bigcategory")?"GCI-11-SR-".concat(t,"-").concat(e.data):"GCI-11-ZC-".concat(t,"-").concat(e.data),l.setFieldsValue({contractno:n})}a.setState({loading:!1})})},a.selectData=function(e){a.setState({linkContarct:e.join("\uff0c")})},a.onSelectRef=function(e){a.child=e},a}return(0,y.default)(t,e),(0,h.default)(t,[{key:"render",value:function(){var e=this,t=this.props.form,a=this.state,l=a.loading,n=a.showSelectModal,g=a.linkContarct,v=a.showLink,h=t.getFieldDecorator,b={md:12,sm:24},C={labelCol:{span:7},wrapperCol:{span:13}},y={showModal:n,linkContarct:g},N={openSelectContratc:this.openSelectContratc,onSelectRef:this.onSelectRef},q=function(){e.setState({showLink:!v}),e.getModelNum()};return w.default.createElement(w.Fragment,null,w.default.createElement(u.default,{style:{marginTop:"24px"},bordered:!1,className:J.default.retCard},w.default.createElement(d.default,{spinning:l},w.default.createElement(S.default,{layout:"inline",className:J.default.addForm},w.default.createElement("h3",{className:F.default.inputBlockTitle},"\u5408\u540c\u6982\u51b5"),w.default.createElement(c.default,null,w.default.createElement(p.default,{className:I.default.lineTextarea},w.default.createElement(P,{label:"\u5408\u540c\u540d\u79f0"},h("contractname",{rules:[{required:!0,message:"\u6b64\u9879\u4e3a\u5fc5\u586b\u9879\uff01"}]})(w.default.createElement(R.default,{placeholder:"\u8bf7\u8f93\u5165\u5408\u540c\u540d\u79f0"})))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u5408\u540c\u7f16\u53f7"},C),h("contractno",{rules:[{required:!0,message:"\u6b64\u9879\u4e3a\u5fc5\u586b\u9879\uff01"}]})(w.default.createElement(R.default,{placeholder:"\u8bf7\u8f93\u5165\u5408\u540c\u7f16\u53f7",disabled:!0,style:{color:"rgba(0,0,0,1)"}})))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u4e1a\u52a1\u7c7b\u578b"},C),h("businesstype",{initialValue:"",rules:[{required:!0,message:"\u6b64\u9879\u4e3a\u5fc5\u586b\u9879\uff01"}]})(w.default.createElement(M.default,null,w.default.createElement(j,{value:""},"\u8bf7\u9009\u62e9"),w.default.createElement(j,{value:"1"},"\u5408\u4f5c"),w.default.createElement(j,{value:"2"},"\u519b\u5de5"),w.default.createElement(j,{value:"3"},"\u5176\u4ed6"),w.default.createElement(j,{value:"4"},"\u533b\u7597"),w.default.createElement(j,{value:"5"},"\u667a\u80fd\u7a7f\u6234"))))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u5408\u540c\u5927\u7c7b"},C),h("bigcategory",{initialValue:"1",rules:[{required:!0,message:"\u6b64\u9879\u4e3a\u5fc5\u586b\u9879\uff01"}]})(w.default.createElement(m.default.Group,{onChange:function(){return q()}},w.default.createElement(m.default,{value:"1"},"\u6536\u5165"),w.default.createElement(m.default,{value:"2"},"\u652f\u51fa"))))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u5408\u540c\u5c0f\u7c7b"},C),h("smallcategory",{initialValue:"",rules:[{required:!0,message:"\u6b64\u9879\u4e3a\u5fc5\u586b\u9879\uff01"}]})(w.default.createElement(M.default,null,w.default.createElement(j,{value:""},"\u8bf7\u9009\u62e9"),w.default.createElement(j,{value:"1"},"\u91c7\u8d2d\u5408\u540c"),w.default.createElement(j,{value:"2"},"\u5de5\u7a0b\u5408\u540c"),w.default.createElement(j,{value:"3"},"\u5408\u4f5c\u534f\u8bae"),w.default.createElement(j,{value:"4"},"\u6280\u672f\u670d\u52a1\u5408\u540c"),w.default.createElement(j,{value:"5"},"\u79df\u8d41\u5408\u540c"))))),w.default.createElement(p.default,{className:I.default.lineTextarea},w.default.createElement(P,{label:"\u5408\u4f5c\u65b9"},h("suppliername",{rules:[{required:!0,message:"\u6b64\u9879\u4e3a\u5fc5\u586b\u9879\uff01"}]})(w.default.createElement(R.default,{placeholder:"\u8bf7\u8f93\u5165\u5408\u4f5c\u65b9"})))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u5408\u4f5c\u65b9\u8d1f\u8d23\u4eba"},C),h("supplierresponsibleperson",{rules:[{required:!0,message:"\u6b64\u9879\u4e3a\u5fc5\u586b\u9879\uff01"}]})(w.default.createElement(R.default,{placeholder:"\u8bf7\u8f93\u5165\u5408\u4f5c\u65b9\u8d1f\u8d23\u4eba"})))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u8054\u7cfb\u7535\u8bdd"},C),h("suppliertelephone",{rules:[{required:!0,message:"\u6b64\u9879\u4e3a\u5fc5\u586b\u9879\uff01"}]})(w.default.createElement(R.default,{placeholder:"\u8bf7\u8f93\u5165\u8054\u7cfb\u7535\u8bdd"})))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u8d23\u4efb\u90e8\u95e8"},C),h("responsibledepartment",{rules:[{required:!0,message:"\u6b64\u9879\u4e3a\u5fc5\u586b\u9879\uff01"}]})(w.default.createElement(R.default,{placeholder:"\u8bf7\u8f93\u5165\u8d23\u4efb\u90e8\u95e8"})))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u7ecf\u529e\u4eba"},C),h("responsibleperson",{initialValue:(0,Y.getReal)(),rules:[{required:!0,message:"\u6b64\u9879\u4e3a\u5fc5\u586b\u9879\uff01"}]})(w.default.createElement(R.default,{placeholder:"\u8bf7\u8f93\u5165\u7ecf\u529e\u4eba"})))),v?"":w.default.createElement(p.default,{className:I.default.lineTextarea},w.default.createElement(P,{label:"\u5408\u540c\u5173\u8054\u60c5\u51b5",className:I.default.spRequired},""===g?"":g.split("\uff0c").map(function(e){return w.default.createElement(s.default,{color:"#108ee9",key:e},e)}),w.default.createElement(o.default,{placement:"topLeft",title:"\u70b9\u51fb\u9009\u62e9\u5173\u8054\u5408\u540c",arrowPointAtCenter:!0},w.default.createElement(i.default,{title:"\u9009\u62e9",onClick:function(){return e.openSelectContratc(!0)},size:"small",style:{marginRight:"10px",padding:"0px 20px"}},"\uff0b")),w.default.createElement("span",null,"\u5df2\u9009\u62e9:")," ",w.default.createElement("span",null,w.default.createElement("b",null,""===g?0:g.split("\uff0c").length)," \u4e2a")))),w.default.createElement("h3",{className:F.default.inputBlockTitle},"\u5408\u540c\u6761\u6b3e"),w.default.createElement(c.default,null,w.default.createElement(p.default,{className:I.default.lineTextarea},w.default.createElement(P,{label:"\u5408\u540c\u6807\u7684"},h("contractcontent")(w.default.createElement(A,{placeholder:"\u8bf7\u8f93\u5165\u5408\u540c\u6807\u7684"})))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u6570\u91cf"},C),h("measurementnumber")(w.default.createElement(R.default,{placeholder:"\u8bf7\u8f93\u5165\u6570\u91cf"})))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u8ba1\u91cf\u5355\u4f4d"},C),h("measurementunit")(w.default.createElement(R.default,{placeholder:"\u8bf7\u8f93\u5165\u8ba1\u91cf\u5355\u4f4d"})))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u5355\u4ef7"},C),h("unitprice",{initialValue:0})(w.default.createElement(f.default,{style:{width:"100%"},step:100,min:0,formatter:function(e){return(0,B.filterRMB)(e,"formatter")},parser:function(e){return(0,B.filterRMB)(e,"parser")}})))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u603b\u6570\u989d"},C),h("totalprice",{initialValue:0,rules:[{required:!0,message:"\u6b64\u9879\u4e3a\u5fc5\u586b\u9879\uff01"},{validator:O.validateToTotalPrice}]})(w.default.createElement(f.default,{style:{width:"100%"},step:100,min:0,formatter:function(e){return(0,B.filterRMB)(e,"formatter")},parser:function(e){return(0,B.filterRMB)(e,"parser")}})))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u7b7e\u7ea6\u65e5\u671f"},C),h("signingdateLong")(w.default.createElement(k.default,null)))),w.default.createElement(p.default,b,w.default.createElement(P,(0,E.default)({label:"\u5f00\u59cb\u4e0e\u7ed3\u675f\u65e5\u671f"},C),h("startEndRange")(w.default.createElement(z,null))))),w.default.createElement(S.default.Item,{style:{textAlign:"center"}},w.default.createElement("div",null,w.default.createElement(i.default,{type:"primary",onClick:function(){return e.btnCurrent()}},"\u4e0b\u4e00\u6b65"))),w.default.createElement(L.default,(0,E.default)({},y,N)))),w.default.createElement(r.default,{style:{margin:"40px 0 24px"}})))}}]),t}(w.default.PureComponent))||V)||V),W=Q;t.default=W}}]);